$(document).ready(function() {
    "use strict";

    $(".toggle-search").on("click", function(e) {
        $(".app").toggleClass("search-visible");
        e.preventDefault();
    });

    $(".content-menu-toggle").on("click", function() {
        $("body").toggleClass("content-menu-shown");
    });

    !function() {
        if ($(".horizontal-menu").length) {
            $(".hide-sidebar-toggle-button").on("click", function(e) {
                e.preventDefault();
                toggleSidebar();
            });

            var e = $(".app-menu li:not(.open) ul"),
                n = $(".app-menu li.active-page > a");

            if ($(window).width() > 1199) {
                if (i != null) {
                    i.destroy();
                    i = null;
                }
            } else {
                var t = document.querySelector(".app-menu");
                i = new PerfectScrollbar(t);
                e.hide();
            }

            $(window).resize(function() {
                if ($(window).width() > 1199 && i != null) {
                    i.destroy();
                    i = null;
                } else {
                    var n = document.querySelector(".app-menu");
                    i = new PerfectScrollbar(n);
                    e.hide();
                }
            });

            $(".app-menu li a").on("click", function(e) {
                var n = $(this).next("ul"),
                    t = $(this).parent("li"),
                    a = $(".app-menu .menu-list > li.open");

                if (n.length) {
                    if ($(window).width() > 1199) {
                        e.preventDefault();
                    } else {
                        if (t.hasClass("open")) {
                            n.slideUp(200);
                            t.removeClass("open");
                            i.update();
                        } else {
                            if (a.length) {
                                t.parent().children(".open").children("ul").slideUp(200);
                                t.parent().children(".open").removeClass("open");
                                i.update();
                            }
                            n.slideDown(200);
                            t.addClass("open");
                            i.update();
                        }
                    }
                    return false;
                }
            });
        }

        if ($(".app-sidebar").length) {
            var i;
            e = $(".accordion-menu li:not(.open) ul");
            n = $(".accordion-menu li.active-page > a");
            e.hide();

            if ($(".app.menu-hover").length && $(window).width() > 1199) {
                if (i != null) {
                    i.destroy();
                    i = null;
                }
            } else {
                var t = document.querySelector(".app-menu");
                i = new PerfectScrollbar(t);
            }

            $(window).resize(function() {
                if ($(".app.menu-hover").length && $(window).width() > 1199 && !i) {
                    var e = document.querySelector(".app-menu");
                    i = new PerfectScrollbar(e);
                } else if (i) {
                    i.destroy();
                    i = null;
                }
            });

            $(".accordion-menu li a").on("click", function(e) {
                var n = $(this).next("ul"),
                    t = $(this).parent("li"),
                    a = $(".accordion-menu > li.open");

                if (n.length) {
                    if ($(".app").hasClass("menu-hover") && $(window).width() > 1199) {
                        e.preventDefault();
                    } else {
                        if (t.hasClass("open")) {
                            n.slideUp(200);
                            t.removeClass("open");
                            i.update();
                        } else {
                            if (a.length) {
                                t.parent().children(".open").children("ul").slideUp(200);
                                t.parent().children(".open").removeClass("open");
                                i.update();
                            }
                            n.slideDown(200);
                            t.addClass("open");
                            i.update();
                        }
                    }
                    return false;
                }
            });

            if ($(".active-page > ul").length) {
                if ($(".app").hasClass("menu-hover")) {
                    if ($(window).width() < 1199) {
                        n.click();
                    }
                } else {
                    n.click();
                }
            }

            if (!$(".app").hasClass("menu-off-canvas")) {
                if ($(window).width() < 1199 && !$(".app").hasClass("sidebar-hidden")) {
                    if (!$(".hide-app-sidebar-mobile").length) {
                        $(".app").append('<div class="hide-app-sidebar-mobile"></div>');
                    }
                    $(".hide-sidebar-toggle-button i").text("last_page");
                } else {
                    $(".hide-sidebar-toggle-button i").text("first_page");
                }

                $(window).resize(function() {
                    if ($(window).width() < 1199 && !$(".app").hasClass("sidebar-hidden")) {
                        if (!$(".hide-app-sidebar-mobile").length) {
                            $(".app").append('<div class="hide-app-sidebar-mobile"></div>');
                        }
                        $(".hide-sidebar-toggle-button i").text("last_page");
                    } else {
                        $(".hide-sidebar-toggle-button i").text("first_page");
                    }
                });
            }

            $(".hide-sidebar-toggle-button").on("click", function(e) {
                e.preventDefault();
                toggleSidebar();
            });

            $(".hide-app-sidebar-mobile").on("click", function(e) {
                e.preventDefault();
                toggleSidebar();
            });

            $(".menu-off-canvas .hide-sidebar-toggle-button").on("click", function() {
                $(".app").toggleClass("menu-off-canvas-show");
                if ($(".app").hasClass("menu-off-canvas-show")) {
                    $(".app-sidebar .logo").addClass("canvas-sidebar-hidden-logo");
                } else {
                    setTimeout(function() {
                        $(".app-sidebar .logo").removeClass("canvas-sidebar-hidden-logo");
                    }, 200);
                }
                return false;
            });
        }

        function toggleSidebar() {
            if (!$(".app").hasClass("menu-off-canvas")) {
                $(".app").toggleClass("sidebar-hidden");
                if ($(".app").hasClass("sidebar-hidden")) {
                    setTimeout(function() {
                        $(".app-sidebar .logo").addClass("hidden-sidebar-logo");
                    }, 200);
                    if ($(window).width() > 1199) {
                        $(".hide-sidebar-toggle-button i").text("last_page");
                    } else {
                        $(".hide-sidebar-toggle-button i").text("first_page");
                    }
                } else {
                    $(".app-sidebar .logo").removeClass("hidden-sidebar-logo");
                    if ($(window).width() > 1199) {
                        $(".hide-sidebar-toggle-button i").text("first_page");
                    } else {
                        $(".hide-sidebar-toggle-button i").text("last_page");
                    }
                }
            }
            return false;
        }
    }();

    $('[data-bs-toggle="popover"]').popover();
    $('[data-bs-toggle="tooltip"]').tooltip();

    window.addEventListener("load", function() {
        var forms = document.getElementsByClassName("needs-validation");
        Array.prototype.filter.call(forms, function(form) {
            form.addEventListener("submit", function(event) {
                if (form.checkValidity() === false) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                form.classList.add("was-validated");
            }, false);
        });
    }, false);

    (function() {
        if ($(".content-menu").length) {
            const e = document.querySelector(".content-menu");
            new PerfectScrollbar(e);
        }
    })();

    if (typeof hljs !== "undefined") {
        hljs.initHighlighting();
    }
});

$(window).on("load", function() {
    setTimeout(function() {
        $("body").addClass("no-loader");
    }, 1000);
});
